<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
    <link rel="icon" type="image/x-icon" href="http://design-pattern.ru/favicon.ico">
    <link rel="stylesheet" type="text/css" href="../css/commons.css">
    <link rel="search" type="application/opensearchdescription+xml" title="Поиск паттернов" href="../search.xml">
    <title>Паттерн Active Record - Активная запись. Описания паттернов проектирования. Паттерны проектирования. Design pattern ru</title>    <meta name="keywords" content="Описания паттернов проектирования, Паттерны проектирования, Design pattern ru, Паттерн Active Record" >    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
</head>
<body>
    <div id="wrapper">
        <div id="header">
            <p><a href="../index.html">Справочник &laquo;Паттерны проектирования&raquo;</a></p>
        </div>

		<div id="content">
            			<h1>Factory Method <em>(Фабричный метод)</em></h1>
			<p><img src="../i/factory-method.png" alt="Паттерн проектирования Factory Method"></p>
			<p><span class="quot">Паттерн проектирования Factory Method</span></p>
			<h2>Описание Factory Method</h2>
			<p>Фабричный метод (англ. Factory Method также известен как Виртуальный конструктор (англ. Virtual Constructor)) — порождающий шаблон проектирования, предоставляющий подклассам интерфейс для создания экземпляров некоторого класса. В момент создания наследники могут определить, какой класс создавать.
                Иными словами, Фабрика делегирует создание объектов наследникам родительского класса. Это позволяет использовать в коде программы не специфические классы, а манипулировать абстрактными объектами на более высоком уровне.</p>
			<p>Определяет интерфейс для создания объекта, но оставляет подклассам решение о том, какой класс инстанцировать. Фабричный метод позволяет классу делегировать создание подклассов. Используется, когда:</p>
            <ul>
                <li>классу заранее неизвестно, объекты каких подклассов ему нужно создавать.</li>
                <li>класс спроектирован так, чтобы объекты, которые он создаёт, специфицировались подклассами.</li>
                <li>класс делегирует свои обязанности одному из нескольких вспомогательных подклассов, и планируется локализовать знание о том, какой класс принимает эти обязанности на себя</li>
            </ul>
            <p>Структура</p>
            <ul>
                <li><b>Product</b> — продукт
                    <ul>
                        <li>определяет интерфейс объектов, создаваемых абстрактным методом;</li>
                    </ul>
                </li>
                <li><b>ConcreteProduct</b> — конкретный продукт
                    <ul>
                        <li>реализует интерфейс <i>Product</i>;</li>
                    </ul>
                </li>
                <li><b>Creator</b> — создатель
                    <ul>
                        <li>объявляет фабричный метод, который возвращает объект типа <i>Product</i>. Может также содержать реализацию этого метода «по умолчанию»;</li>
                        <li>может вызывать фабричный метод для создания объекта типа <i>Product</i>;</li>
                    </ul>
                </li>
                <li><b>ConcreteCreator</b> — конкретный создатель
                    <ul>
                        <li>переопределяет фабричный метод таким образом, чтобы он создавал и возвращал объект класса <i>ConcreteProduct</i>.</li>
                    </ul>
                </li>
            </ul>
            
            <h2>Примеры реализации</h2>
            <div class="code-snippet">
                <div class="code-snippet-header">
                    <button class="code-snippet-tab" data-language="javascript">JavaScript</button>
                    <button class="code-snippet-tab" data-language="cpp">C++</button>
                    <button class="code-snippet-tab" data-language="go">Go</button>
                    <button class="code-snippet-tab" data-language="python">Python</button>
                    <button class="code-snippet-tab" data-language="php">PHP</button>
                </div>
                <div class="code-snippet-content">
                    <button class="code-snippet-copy">Copy</button>
                    
                    <div class="code-snippet-panel" data-language="javascript">
                        <pre><code>// Factory Method Pattern in JavaScript
class Product {
    operation() {
        throw new Error('Method must be implemented');
    }
}

class ConcreteProductA extends Product {
    operation() {
        return 'ConcreteProductA operation';
    }
}

class ConcreteProductB extends Product {
    operation() {
        return 'ConcreteProductB operation';
    }
}

class Creator {
    factoryMethod() {
        throw new Error('Method must be implemented');
    }
    
    someOperation() {
        const product = this.factoryMethod();
        return product.operation();
    }
}

class ConcreteCreatorA extends Creator {
    factoryMethod() {
        return new ConcreteProductA();
    }
}

class ConcreteCreatorB extends Creator {
    factoryMethod() {
        return new ConcreteProductB();
    }
}

// Usage
const creatorA = new ConcreteCreatorA();
const creatorB = new ConcreteCreatorB();

console.log(creatorA.someOperation());
console.log(creatorB.someOperation());</code></pre>
                    </div>
                    
                    <div class="code-snippet-panel" data-language="cpp">
                        <pre><code>// Factory Method Pattern in C++
#include &lt;iostream&gt;
#include &lt;memory&gt;

class Product {
public:
    virtual ~Product() = default;
    virtual std::string operation() = 0;
};

class ConcreteProductA : public Product {
public:
    std::string operation() override {
        return "ConcreteProductA operation";
    }
};

class ConcreteProductB : public Product {
public:
    std::string operation() override {
        return "ConcreteProductB operation";
    }
};

class Creator {
public:
    virtual ~Creator() = default;
    virtual std::unique_ptr&lt;Product&gt; factoryMethod() = 0;
    
    std::string someOperation() {
        auto product = factoryMethod();
        return product->operation();
    }
};

class ConcreteCreatorA : public Creator {
public:
    std::unique_ptr&lt;Product&gt; factoryMethod() override {
        return std::make_unique&lt;ConcreteProductA&gt;();
    }
};

class ConcreteCreatorB : public Creator {
public:
    std::unique_ptr&lt;Product&gt; factoryMethod() override {
        return std::make_unique&lt;ConcreteProductB&gt;();
    }
};</code></pre>
                    </div>
                    
                    <div class="code-snippet-panel" data-language="go">
                        <pre><code>// Factory Method Pattern in Go
package main

import "fmt"

type Product interface {
    Operation() string
}

type ConcreteProductA struct{}

func (p *ConcreteProductA) Operation() string {
    return "ConcreteProductA operation"
}

type ConcreteProductB struct{}

func (p *ConcreteProductB) Operation() string {
    return "ConcreteProductB operation"
}

type Creator interface {
    FactoryMethod() Product
    SomeOperation() string
}

type ConcreteCreatorA struct{}

func (c *ConcreteCreatorA) FactoryMethod() Product {
    return &ConcreteProductA{}
}

func (c *ConcreteCreatorA) SomeOperation() string {
    product := c.FactoryMethod()
    return product.Operation()
}

type ConcreteCreatorB struct{}

func (c *ConcreteCreatorB) FactoryMethod() Product {
    return &ConcreteProductB{}
}

func (c *ConcreteCreatorB) SomeOperation() string {
    product := c.FactoryMethod()
    return product.Operation()
}

// Usage
func main() {
    creatorA := &ConcreteCreatorA{}
    creatorB := &ConcreteCreatorB{}
    
    fmt.Println(creatorA.SomeOperation())
    fmt.Println(creatorB.SomeOperation())
}</code></pre>
                    </div>
                    
                    <div class="code-snippet-panel" data-language="python">
                        <pre><code># Factory Method Pattern in Python
from abc import ABC, abstractmethod

class Product(ABC):
    @abstractmethod
    def operation(self):
        pass

class ConcreteProductA(Product):
    def operation(self):
        return "ConcreteProductA operation"

class ConcreteProductB(Product):
    def operation(self):
        return "ConcreteProductB operation"

class Creator(ABC):
    @abstractmethod
    def factory_method(self):
        pass
    
    def some_operation(self):
        product = self.factory_method()
        return product.operation()

class ConcreteCreatorA(Creator):
    def factory_method(self):
        return ConcreteProductA()

class ConcreteCreatorB(Creator):
    def factory_method(self):
        return ConcreteProductB()

# Usage
if __name__ == "__main__":
    creator_a = ConcreteCreatorA()
    creator_b = ConcreteCreatorB()
    
    print(creator_a.some_operation())
    print(creator_b.some_operation())</code></pre>
                    </div>
                    
                    <div class="code-snippet-panel" data-language="php">
                        <pre><code>&lt;?php
// Factory Method Pattern in PHP
abstract class Product {
    abstract public function operation(): string;
}

class ConcreteProductA extends Product {
    public function operation(): string {
        return "ConcreteProductA operation";
    }
}

class ConcreteProductB extends Product {
    public function operation(): string {
        return "ConcreteProductB operation";
    }
}

abstract class Creator {
    abstract public function factoryMethod(): Product;
    
    public function someOperation(): string {
        $product = $this->factoryMethod();
        return $product->operation();
    }
}

class ConcreteCreatorA extends Creator {
    public function factoryMethod(): Product {
        return new ConcreteProductA();
    }
}

class ConcreteCreatorB extends Creator {
    public function factoryMethod(): Product {
        return new ConcreteProductB();
    }
}

// Usage
$creatorA = new ConcreteCreatorA();
$creatorB = new ConcreteCreatorB();

echo $creatorA->someOperation() . "\n";
echo $creatorB->someOperation() . "\n";
?&gt;</code></pre>
                    </div>
                </div>
            </div>
            
            <br>
			<!--<p class="expamle"><span class="ex_title">Пример:</span> объект "Работник" содержит данные об одном работнике и методы: добавить, обновить или удалить. Помимо прочего, отдельным методом вынесена <em>смена имени.</em></p>			<p class="note">Использована иллюстрация с сайта <a href="../martin-fowler.html">Мартина Фаулера</a> со страницы о паттерне <noindex><a href="http://martinfowler.com/eaaCatalog/activeRecord.html">Active Record</a></noindex></p>			<p class="note"><noindex><a href="http://martinfowler.com/eaaCatalog/activeRecord.html">Источник</a></noindex></p>        </div>-->
        <div style="clear:both;margin-top: -2.5em">&nbsp;</div>
    </div>
    <ul id="footer-menu">
    	<li><a href="../index.html">Главная</a></li>
        <li><a href="index.html" title="Список шаблонов проектирования">Список паттернов</a></li>
        <li>Сайт создан и поддерживается <a href="https://vasiliy.pro">Василием Кулаковым</a>.</li>
    </ul>

   <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3BEMCB742Q"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3BEMCB742Q');
</script><!-- Yandex.Metrika counter -->
<div style="display:none;"><script type="text/javascript">
(function(w, c) {
    (w[c] = w[c] || []).push(function() {
        try {
            w.yaCounter6876103 = new Ya.Metrika({id:6876103,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true});
        }
        catch(e) { }
    });
})(window, 'yandex_metrika_callbacks');
</script></div>
<script src="http://mc.yandex.ru/metrika/watch.js" type="text/javascript" defer="defer"></script>
<noscript><div><img src="http://mc.yandex.ru/watch/6876103" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Code Snippet JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Initialize all code snippet components
    const codeSnippets = document.querySelectorAll('.code-snippet');
    
    codeSnippets.forEach(function(snippet) {
        const tabs = snippet.querySelectorAll('.code-snippet-tab');
        const panels = snippet.querySelectorAll('.code-snippet-panel');
        const copyButton = snippet.querySelector('.code-snippet-copy');
        
        // Set default active tab (JavaScript)
        const defaultTab = snippet.querySelector('[data-language="javascript"]');
        if (defaultTab) {
            defaultTab.classList.add('active');
            const defaultPanel = snippet.querySelector('.code-snippet-panel[data-language="javascript"]');
            if (defaultPanel) {
                defaultPanel.classList.add('active');
            }
        }
        
        // Tab switching functionality
        tabs.forEach(function(tab) {
            tab.addEventListener('click', function() {
                const language = this.getAttribute('data-language');
                
                // Remove active class from all tabs and panels
                tabs.forEach(t => t.classList.remove('active'));
                panels.forEach(p => p.classList.remove('active'));
                
                // Add active class to clicked tab and corresponding panel
                this.classList.add('active');
                const targetPanel = snippet.querySelector(`.code-snippet-panel[data-language="${language}"]`);
                if (targetPanel) {
                    targetPanel.classList.add('active');
                }
            });
        });
        
        // Copy functionality
        if (copyButton) {
            copyButton.addEventListener('click', function() {
                const activePanel = snippet.querySelector('.code-snippet-panel.active');
                if (activePanel) {
                    const codeText = activePanel.textContent;
                    
                    // Copy to clipboard
                    navigator.clipboard.writeText(codeText).then(function() {
                        copyButton.textContent = 'Copied!';
                        copyButton.classList.add('copied');
                        
                        setTimeout(function() {
                            copyButton.textContent = 'Copy';
                            copyButton.classList.remove('copied');
                        }, 2000);
                    }).catch(function(err) {
                        console.error('Failed to copy text: ', err);
                    });
                }
            });
        }
    });
});
</script>
</body>
</html>